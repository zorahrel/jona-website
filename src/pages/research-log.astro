---
import Layout from "../layouts/Layout.astro";

const sections = [
  {
    id: "herstories",
    label: "HERstories",
    code: "Ⓣ⓪➀",
    location: "Femminamorta, Giarre",
    duration: "13-16/8/2025",
    facilitator: "Hiram Salsano, Rachele Andrioli, Barbara Crescimanno",
    content: [
      "The masterclass is led by teachers from different regions of Southern Italy (Puglia, Sicily, Campania), who will guide participants through the women's vocal and percussion repertoire of the South, and into the relationship between body movement and frame drum, drawing on techniques of the ancient Greek chorus and its rhythmic–choral movement in space.",
      "Starting from the dynamics of the percussion circle, the work expands into movement through space, exploring how bodies and sounds relate physically and rhythmically in lines and ranks, and then in more complex formations such as diamonds, flocks, and packs.",
      "Through choral movement, traditional singing, and percussion, participants will work on homophony/unison and vocal and percussive polyrhythms; on the voice as it is tied to gesture and movement; and on the drum as both musical and expressive instrument.",
      "Drawing on each participant's skills and capacities, the masterclass encourages group-based artistic creation, helping everyone to engage with and gradually master the mechanisms of collective performance.",
    ],
  },
  {
    id: "cantare",
    label: "CANTARE NEI LUOGHI",
    code: "Ⓣ⓪➁",
    location: "TBD",
    duration: "TBD",
    facilitator: "TBD",
    content: [
      "An exploration of site-specific singing practices, investigating how voice and acoustic space create meaning together. This research track examines the relationship between traditional singing practices and the environments in which they were performed and developed.",
      "The project explores how geographical, architectural, and natural spaces have shaped vocal techniques, repertoires, and the social functions of singing across Mediterranean cultures.",
    ],
  },
  {
    id: "choros",
    label: "CHOROS",
    code: "Ⓣ⓪➂",
    location: "TBD",
    duration: "TBD",
    facilitator: "TBD",
    content: [
      "An investigation into the ancient Greek chorus as a model for collective embodied practice. This research explores the techniques and principles of choral movement, rhythm, and voice that connected individuals to their community and cosmos.",
      "The chorus was more than performance—it was a technology of coordination, synchronization, and collective intelligence that this research seeks to understand and reactivate.",
    ],
  },
  {
    id: "ccta",
    label: "CCTA",
    code: "Ⓣ⓪➃",
    location: "TBD",
    duration: "TBD",
    facilitator: "TBD",
    content: [
      "Cross-Cultural Transmodal Aesthetics: an interdisciplinary investigation into how different cultures perceive, process, and express sensory experience across modalities.",
      "This research examines the bridges between sound, movement, visual perception, and meaning-making, seeking universal patterns and culturally-specific innovations in human aesthetic experience.",
    ],
  },
  {
    id: "embodied",
    label: "EMBODIED MUSICALITY",
    code: "Ⓣ⓪➄",
    location: "TBD",
    duration: "TBD",
    facilitator: "TBD",
    content: [
      "An exploration of how musical knowledge is stored, transmitted, and expressed through the body. This research investigates the somatic dimensions of musical practice—how rhythm lives in the muscles, how melody is felt in the breath.",
      "The project draws on neuroscience, phenomenology, and traditional practices to understand how the body thinks musically and how this embodied intelligence can be cultivated and shared.",
    ],
  },
];
---

<Layout
  title="Research Log - Design for the Continuum"
  activePage="research-log"
>
  <div class="page-wrapper">
    <div class="accordion-fan">
      {
        sections.map((section, index) => (
          <div
            class:list={["fan-panel", index === 0 ? "expanded" : ""]}
            data-index={index}
          >
            <!-- Tab/Handle -->
            <button class="panel-tab" aria-expanded={index === 0 ? "true" : "false"}>
              <div class="tab-border" />
              <div class="tab-text-wrapper">
                <span class="tab-label">{section.label}</span>
                <span class="tab-code">{section.code}</span>
              </div>
            </button>

            <!-- Expandable Content -->
            <div class="panel-content">
              <div class="content-scroll">
                <div class="content-inner">
                  <div class="pink-bar" />
                  <div class="content-body">
                    <h1 class="title">{section.label}</h1>
                    <p class="code">{section.code}</p>

                    <div class="meta">
                      <p>location: {section.location}</p>
                      <p>duration: {section.duration}</p>
                      <p>facilitator: {section.facilitator}</p>
                    </div>

                    <div class="two-column">
                      <div class="image-placeholder" />
                      <div class="text-content">
                        {section.content.map((p) => (
                          <p>{p}</p>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</Layout>

<style>
  /* ===== PAGE WRAPPER ===== */
  .page-wrapper {
    padding: 0 1.5rem 1.5rem;
  }

  @media (min-width: 1024px) {
    .page-wrapper {
      padding: 0 4rem 2rem;
    }
  }

  .accordion-fan {
    display: inline-flex;
    width: 100%;
    overflow: hidden;
  }

  /* ===== PANEL ===== */
  .fan-panel {
    display: flex;
    flex-shrink: 0;
    transition: flex-grow 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .fan-panel:not(.expanded) {
    flex-grow: 0;
  }

  .fan-panel.expanded {
    flex-grow: 1;
  }

  /* ===== TAB ===== */
  .panel-tab {
    width: 60px;
    flex-shrink: 0;
    /* Gradient orizzontale: rosa solido a sinistra che sfuma verso crema/trasparente */
    background: linear-gradient(
      to right,
      #ff7bac 0%,
      rgba(255, 123, 172, 0.6) 15%,
      rgba(255, 123, 172, 0.3) 40%,
      rgba(255, 123, 172, 0.1) 70%,
      #fafaf8 100%
    );
    border: none;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    padding-top: 2rem;
    position: relative;
    transition: all 0.3s ease;
  }

  .panel-tab:hover {
    background: linear-gradient(
      to right,
      #ff7bac 0%,
      rgba(255, 123, 172, 0.8) 20%,
      rgba(255, 123, 172, 0.5) 50%,
      rgba(255, 123, 172, 0.2) 80%,
      #fafaf8 100%
    );
  }

  .fan-panel.expanded .panel-tab {
    background: linear-gradient(
      to right,
      #ff7bac 0%,
      #ff7bac 10%,
      rgba(255, 123, 172, 0.7) 30%,
      rgba(255, 123, 172, 0.4) 60%,
      #fafaf8 100%
    );
  }

  .tab-border {
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 2px;
    background: #1d1d1b;
  }

  .tab-text-wrapper {
    writing-mode: vertical-lr;
    text-orientation: mixed;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
  }

  .tab-label {
    font-weight: 900;
    font-size: 1.125rem;
    letter-spacing: 0.01em;
    color: #1d1d1b;
    text-transform: uppercase;
  }

  .tab-code {
    font-weight: 600;
    font-size: 1rem;
    opacity: 0.7;
    color: #1d1d1b;
  }

  /* ===== CONTENT ===== */
  .panel-content {
    flex-grow: 1;
    background: #fafaf8;
    overflow: hidden;
    width: 0;
    opacity: 0;
    transition:
      width 0.5s cubic-bezier(0.4, 0, 0.2, 1),
      opacity 0.3s ease;
  }

  .fan-panel.expanded .panel-content {
    width: auto;
    opacity: 1;
    transition:
      width 0.5s cubic-bezier(0.4, 0, 0.2, 1),
      opacity 0.4s ease 0.2s;
  }

  .content-inner {
    display: flex;
    gap: 1.5rem;
    padding: 2rem 3rem;
  }

  .pink-bar {
    width: 8px;
    flex-shrink: 0;
    background: linear-gradient(to bottom, #ff7bac, rgba(255, 123, 172, 0.5), transparent);
  }

  .content-body {
    flex: 1;
    max-width: 900px;
  }

  .title {
    font-size: clamp(3rem, 7vw, 5.5rem);
    font-weight: 900;
    line-height: 0.92;
    margin-bottom: 0.25rem;
    color: #1d1d1b;
    letter-spacing: -0.02em;
  }

  .code {
    font-size: clamp(1.75rem, 4vw, 2.75rem);
    font-weight: 900;
    line-height: 1;
    margin-bottom: 1.5rem;
    color: #1d1d1b;
  }

  .meta {
    font-size: 0.9375rem;
    font-weight: 600;
    line-height: 1.5;
    margin-bottom: 2rem;
    color: #1d1d1b;
  }

  .meta p {
    margin: 0.125rem 0;
  }

  .two-column {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 2rem;
    align-items: start;
  }

  .image-placeholder {
    width: 100%;
    aspect-ratio: 1 / 1;
    max-width: 280px;
    background: #1d1d1b;
  }

  .text-content {
    font-size: 1.0625rem;
    font-weight: 600;
    line-height: 1.45;
    color: #1d1d1b;
  }

  .text-content p {
    margin-bottom: 1.5rem;
  }

  .text-content p:last-child {
    margin-bottom: 0;
  }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 1024px) {
    .panel-tab {
      width: 50px;
    }

    .tab-label {
      font-size: 0.875rem;
    }

    .tab-code {
      font-size: 0.8125rem;
    }

    .content-inner {
      padding: 1.5rem 2rem;
    }

    .two-column {
      grid-template-columns: 200px 1fr;
      gap: 1.5rem;
    }

    .image-placeholder {
      max-width: 200px;
    }
  }

  @media (max-width: 768px) {
    .panel-tab {
      width: 40px;
      padding-top: 1.5rem;
    }

    .tab-label {
      font-size: 0.6875rem;
    }

    .tab-code {
      font-size: 0.6875rem;
    }

    .content-inner {
      padding: 1rem 1.5rem;
      flex-direction: column;
      gap: 1rem;
    }

    .pink-bar {
      width: 100%;
      height: 6px;
      min-height: auto;
      background: linear-gradient(to right, #ff7bac, rgba(255, 123, 172, 0.5), transparent);
    }

    .two-column {
      grid-template-columns: 1fr;
    }

    .image-placeholder {
      max-width: 100%;
      aspect-ratio: 16 / 9;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const panels = document.querySelectorAll<HTMLElement>(".fan-panel");
    const tabs = document.querySelectorAll<HTMLButtonElement>(".panel-tab");

    tabs.forEach((tab, index) => {
      tab.addEventListener("click", () => {
        // Remove expanded from all
        panels.forEach((p) => p.classList.remove("expanded"));
        tabs.forEach((t) => t.setAttribute("aria-expanded", "false"));

        // Add expanded to clicked
        panels[index].classList.add("expanded");
        tab.setAttribute("aria-expanded", "true");
      });
    });

    // Keyboard navigation
    document.addEventListener("keydown", (e) => {
      const currentIndex = Array.from(panels).findIndex((p) =>
        p.classList.contains("expanded")
      );

      if (e.key === "ArrowRight") {
        e.preventDefault();
        const next = Math.min(currentIndex + 1, panels.length - 1);
        tabs[next].click();
      } else if (e.key === "ArrowLeft") {
        e.preventDefault();
        const prev = Math.max(currentIndex - 1, 0);
        tabs[prev].click();
      }
    });
  });
</script>
